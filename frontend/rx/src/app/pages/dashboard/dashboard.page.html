<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Dashboard</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-menu side="start" menuId="first" contentId="main-content">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-title>Menu</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-menu-toggle auto-hide="false">
        <ion-item button (click)="navigateTo('dashboard')">
          <ion-icon name="home-outline" slot="start"></ion-icon>
          <ion-label>Dashboard</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('doctor-profile')">
          <ion-icon name="person-outline" slot="start"></ion-icon>
          <ion-label>My Profile</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('patients')">
          <ion-icon name="people-outline" slot="start"></ion-icon>
          <ion-label>Patients</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('create-prescription')">
          <ion-icon name="document-text-outline" slot="start"></ion-icon>
          <ion-label>Create Prescription</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('prescriptions')">
          <ion-icon name="documents-outline" slot="start"></ion-icon>
          <ion-label>Prescriptions</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('create-certificate')">
          <ion-icon name="medkit-outline" slot="start"></ion-icon>
          <ion-label>Create Certificate</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('certificates')">
          <ion-icon name="folder-open-outline" slot="start"></ion-icon>
          <ion-label>Certificates</ion-label>
        </ion-item>
        
        <ion-item button (click)="navigateTo('medicines')">
          <ion-icon name="medical-outline" slot="start"></ion-icon>
          <ion-label>Medicines</ion-label>
        </ion-item>
        
        <ion-item button (click)="logout()" color="danger">
          <ion-icon name="log-out-outline" slot="start"></ion-icon>
          <ion-label>Logout</ion-label>
        </ion-item>
      </ion-menu-toggle>
    </ion-list>
  </ion-content>
</ion-menu>

<ion-content [fullscreen]="true" id="main-content">
  <ion-refresher slot="fixed" (ionRefresh)="refreshData($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="dashboard-container">
    <!-- Welcome Section -->
    <ion-card class="welcome-card">
      <ion-card-header>
        <ion-card-title>
          Welcome, Dr. {{profile?.full_name || 'Doctor'}}!
        </ion-card-title>
        <ion-card-subtitle>
          {{profile?.specialization || 'Medical Practitioner'}}
        </ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <p>{{profile?.clinic_name || 'Medical Clinic'}}</p>
        <p>{{profile?.clinic_address || ''}}</p>
      </ion-card-content>
    </ion-card>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h2>Quick Actions</h2>
      <ion-grid>
        <ion-row>
          <ion-col size="6" size-md="3" *ngFor="let action of quickActions">
            <ion-card class="action-card" button (click)="navigateTo(action.route)">
              <ion-card-content>
                <div class="action-icon">
                  <ion-icon [name]="action.icon" color="primary"></ion-icon>
                </div>
                <h3>{{action.label}}</h3>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <!-- Statistics -->
    <div class="statistics">
      <h2>Statistics</h2>
      <ion-grid>
        <ion-row>
          <ion-col size="12" size-md="4">
            <ion-card class="stat-card" color="primary">
              <ion-card-content>
                <div class="stat-content">
                  <div class="stat-icon">
                    <ion-icon name="people-outline"></ion-icon>
                  </div>
                  <div class="stat-info">
                    <h3>{{stats.patients}}</h3>
                    <p>Patients</p>
                  </div>
                </div>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size="12" size-md="4">
            <ion-card class="stat-card" color="success">
              <ion-card-content>
                <div class="stat-content">
                  <div class="stat-icon">
                    <ion-icon name="document-text-outline"></ion-icon>
                  </div>
                  <div class="stat-info">
                    <h3>{{stats.prescriptions}}</h3>
                    <p>Prescriptions</p>
                  </div>
                </div>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size="12" size-md="4">
            <ion-card class="stat-card" color="warning">
              <ion-card-content>
                <div class="stat-content">
                  <div class="stat-icon">
                    <ion-icon name="ribbon-outline"></ion-icon>
                  </div>
                  <div class="stat-info">
                    <h3>{{stats.certificates}}</h3>
                    <p>Certificates</p>
                  </div>
                </div>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <!-- Recent Activity -->
    <div class="recent-activity">
      <h2>Recent Prescriptions</h2>
      <ion-card *ngIf="recentPrescriptions.length === 0">
        <ion-card-content class="empty-state">
          <ion-icon name="document-text-outline"></ion-icon>
          <p>No prescriptions created yet</p>
          <ion-button (click)="navigateTo('create-prescription')" color="primary">
            Create First Prescription
          </ion-button>
        </ion-card-content>
      </ion-card>
      
      <ion-list *ngIf="recentPrescriptions.length > 0">
        <ion-item *ngFor="let prescription of recentPrescriptions" button>
          <ion-label>
            <h3>{{prescription.patient_name}}</h3>
            <p>{{prescription.chief_complaint}}</p>
            <p class="date">{{prescription.created_at | date}}</p>
          </ion-label>
          <ion-badge slot="end" color="primary">
            View
          </ion-badge>
        </ion-item>
      </ion-list>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="dashboard-loading">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading dashboard...</p>
  </div>
</ion-content>